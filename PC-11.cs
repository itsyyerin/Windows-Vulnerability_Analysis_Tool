using Microsoft.Win32;
using System;

namespace Windows_Vulnerability_Analysis_Tool
{
    public class PC_11
    {
        public int CheckFirewallStatus()
        {
            bool isWindowsFirewallEnabled = IsWindowsFirewallEnabled();
            return isWindowsFirewallEnabled ? 1 : 0;
        }

        private bool IsWindowsFirewallEnabled()
        {
            using (RegistryKey key = Registry.LocalMachine.OpenSubKey(@"System\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile"))
            {
                if (key != null)
                {
                    object o = key.GetValue("EnableFireWall");
                    if (o != null)
                    {
                        return (int)o == 1;
                    }
                }
            }
            throw new Exception("윈도우 방화벽 설정을 찾을 수 없습니다.");
        }
    }
}
